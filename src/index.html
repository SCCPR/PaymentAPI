<!DOCTYPE html>
<html lang="pt-BR">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Sistema Bancário</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>

<body>
  <div class="container mt-5">
    <h1>Sistema Bancário</h1>

    <!-- Adicionar Cliente -->
    <div class="mb-5">
      <h2>Adicionar Cliente</h2>
      <form id="form-cliente">
        <div class="mb-3">
          <label for="nome_cliente" class="form-label">Nome do Cliente</label>
          <input type="text" class="form-control" id="nome_cliente" required>
        </div>
        <div class="mb-3">
          <label for="data_nascimento" class="form-label">Data de Nascimento (YYYY-MM-DD)</label>
          <input type="date" class="form-control" id="data_nascimento" required>
        </div>
        <div class="mb-3">
          <label for="numero_conta" class="form-label">Número da Conta</label>
          <input type="text" class="form-control" id="numero_conta" required>
        </div>
        <div class="mb-3">
          <label for="saldo" class="form-label">Saldo Inicial</label>
          <input type="number" class="form-control" id="saldo" step="0.01" required>
        </div>
        <button type="submit" class="btn btn-primary">Adicionar Cliente</button>
      </form>
    </div>

    <!-- Listar Clientes -->
    <div class="mb-5">
      <h2>Clientes</h2>
      <ul id="clientes-list" class="list-group">
        <!-- Clientes serão listados aqui -->
      </ul>
    </div>

    <!-- Adicionar Conta -->
    <div class="mb-5">
      <h2>Adicionar Conta</h2>
      <form id="form-conta">
        <div class="mb-3">
          <label for="numero_conta_adicionar" class="form-label">Número da Conta</label>
          <input type="text" class="form-control" id="numero_conta_adicionar" required>
        </div>
        <div class="mb-3">
          <label for="id_cliente" class="form-label">ID do Cliente Associado</label>
          <input type="number" class="form-control" id="id_cliente" required>
        </div>
        <button type="submit" class="btn btn-primary">Adicionar Conta</button>
      </form>
    </div>

    <!-- Listar Contas -->
    <div class="mb-5">
      <h2>Contas</h2>
      <ul id="contas-list" class="list-group">
        <!-- Contas serão listadas aqui -->
      </ul>
    </div>

    <!-- Realizar Transação -->
    <div class="mb-5">
      <h2>Realizar Transação</h2>
      <form id="form-transacao">
        <div class="mb-3">
          <label for="id_cliente_envio" class="form-label">ID do Cliente que está Enviando</label>
          <input type="number" class="form-control" id="id_cliente_envio" required>
        </div>
        <div class="mb-3">
          <label for="id_cliente_recebimento" class="form-label">ID do Cliente que está Recebendo</label>
          <input type="number" class="form-control" id="id_cliente_recebimento" required>
        </div>
        <div class="mb-3">
          <label for="valor_transacao" class="form-label">Valor da Transação</label>
          <input type="number" class="form-control" id="valor_transacao" step="0.01" required>
        </div>
        <div class="mb-3">
          <label for="tipo_transacao" class="form-label">Tipo de Transação</label>
          <input type="text" class="form-control" id="tipo_transacao" required>
        </div>
        <button type="submit" class="btn btn-primary">Realizar Transação</button>
      </form>
    </div>

    <!-- Listar Transações -->
    <div class="mb-5">
      <h2>Transações</h2>
      <ul id="transacoes-list" class="list-group">
        <!-- Transações serão listadas aqui -->
      </ul>
    </div>

    <!-- Adicionar Categoria -->
    <div class="mb-5">
      <h2>Adicionar Categoria</h2>
      <form id="form-categoria">
        <div class="mb-3">
          <label for="nome_categoria" class="form-label">Nome da Categoria</label>
          <input type="text" class="form-control" id="nome_categoria" required>
        </div>
        <button type="submit" class="btn btn-primary">Adicionar Categoria</button>
      </form>
    </div>

    <!-- Listar Categorias -->
    <div class="mb-5">
      <h2>Categorias</h2>
      <ul id="categorias-list" class="list-group">
        <!-- Categorias serão listadas aqui -->
      </ul>
    </div>
  </div>

  <script>
    const apiUrl = 'http://localhost:3000';

    // Adicionar Cliente
    document.getElementById('form-cliente').addEventListener('submit', async (e) => {
      e.preventDefault();
      const nome_cliente = document.getElementById('nome_cliente').value;
      const data_nascimento = document.getElementById('data_nascimento').value;
      const numero_conta = document.getElementById('numero_conta').value;
      const saldo = parseFloat(document.getElementById('saldo').value);

      try {
        await fetch(`${apiUrl}/clientes`, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ nome_cliente, data_nascimento, numero_conta, saldo })
        });
        alert('Cliente adicionado com sucesso!');
        listarClientes();
      } catch (error) {
        console.error('Erro ao adicionar cliente:', error);
      }
    });

    async function listarClientes() {
      try {
        const response = await fetch(`${apiUrl}/clientes`);
        const clientes = await response.json();
        const clientesList = document.getElementById('clientes-list');
        clientesList.innerHTML = '';
        clientes.forEach(cliente => {
          const listItem = document.createElement('li');
          listItem.className = 'list-group-item';
          listItem.textContent = `${cliente.nome_cliente} - Conta: ${cliente.numero_conta} - Saldo: ${cliente.saldo}`;
          clientesList.appendChild(listItem);
        });
      } catch (error) {
        console.error('Erro ao listar clientes:', error);
      }
    }

    // Adicionar Conta
    document.getElementById('form-conta').addEventListener('submit', async (e) => {
      e.preventDefault();
      const numero_conta = document.getElementById('numero_conta_adicionar').value;
      const id_cliente = parseInt(document.getElementById('id_cliente').value);

      try {
        await fetch(`${apiUrl}/contas`, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ numero_conta, id_cliente })
        });
        alert('Conta adicionada com sucesso!');
        listarContas();
      } catch (error) {
        console.error('Erro ao adicionar conta:', error);
      }
    });

    async function listarContas() {
      try {
        const response = await fetch(`${apiUrl}/contas`);
        const contas = await response.json();
        const contasList = document.getElementById('contas-list');
        contasList.innerHTML = '';
        contas.forEach(conta => {
          const listItem = document.createElement('li');
          listItem.className = 'list-group-item';
          listItem.textContent = `Conta: ${conta.numero_conta} - Data de Abertura: ${conta.data_abertura}`;
          contasList.appendChild(listItem);
        });
      } catch (error) {
        console.error('Erro ao listar contas:', error);
      }
    }

    // Realizar Transação
    document.getElementById('form-transacao').addEventListener('submit', async (e) => {
      e.preventDefault();
      const id_cliente_envio = parseInt(document.getElementById('id_cliente_envio').value);
      const id_cliente_recebimento = parseInt(document.getElementById('id_cliente_recebimento').value);
      const valor = parseFloat(document.getElementById('valor_transacao').value);
      const tipo_transacao = document.getElementById('tipo_transacao').value;

      try {
        await fetch(`${apiUrl}/transacoes`, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ id_cliente_envio, id_cliente_recebimento, valor, tipo_transacao })
        });
        alert('Transação realizada com sucesso!');
        listarTransacoes();
      } catch (error) {
        console.error('Erro ao realizar transação:', error);
      }
    });

    async function listarTransacoes() {
      try {
        const response = await fetch(`${apiUrl}/transacoes`);
        const transacoes = await response.json();
        const transacoesList = document.getElementById('transacoes-list');
        transacoesList.innerHTML = '';
        transacoes.forEach(transacao => {
          const listItem = document.createElement('li');
          listItem.className = 'list-group-item';
          listItem.textContent = `${transacao.tipo_transacao} - Valor: ${transacao.valor} - Data: ${transacao.data}`;
          transacoesList.appendChild(listItem);
        });
      } catch (error) {
        console.error('Erro ao listar transações:', error);
      }
    }

    // Adicionar Categoria
    document.getElementById('form-categoria').addEventListener('submit', async (e) => {
      e.preventDefault();
      const nome_categoria = document.getElementById('nome_categoria').value;

      try {
        await fetch(`${apiUrl}/categorias`, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ nome_categoria })
        });
        alert('Categoria adicionada com sucesso!');
        listarCategorias();
      } catch (error) {
        console.error('Erro ao adicionar categoria:', error);
      }
    });

    async function listarCategorias() {
      try {
        const response = await fetch(`${apiUrl}/categorias`);
        const categorias = await response.json();
        const categoriasList = document.getElementById('categorias-list');
        categoriasList.innerHTML = '';
        categorias.forEach(categoria => {
          const listItem = document.createElement('li');
          listItem.className = 'list-group-item';
          listItem.textContent = `${categoria.nome_categoria}`;
          categoriasList.appendChild(listItem);
        });
      } catch (error) {
        console.error('Erro ao listar categorias:', error);
      }
    }

    // Carregar todos os dados na inicialização
    listarClientes();
    listarContas();
    listarTransacoes();
    listarCategorias();
  </script>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>

</html>